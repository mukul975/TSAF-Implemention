{{ define "slack.tsaf.title" }}
{{ if eq .Status "firing" }}ğŸ”¥ TSAF Alert FIRING{{ else }}âœ… TSAF Alert RESOLVED{{ end }}
{{ end }}

{{ define "slack.tsaf.text" }}
{{ range .Alerts }}
*{{ .Annotations.summary }}*
{{ .Annotations.description }}

*Service:* {{ .Labels.service }}
*Severity:* {{ .Labels.severity | upper }}
{{ if .Labels.category }}*Category:* {{ .Labels.category }}{{ end }}
{{ if .Labels.agent_id }}*Agent:* {{ .Labels.agent_id }}{{ end }}
{{ if .Labels.protocol }}*Protocol:* {{ .Labels.protocol }}{{ end }}

*Started:* {{ .StartsAt.Format "15:04:05 UTC" }}
{{ if .EndsAt }}*Ended:* {{ .EndsAt.Format "15:04:05 UTC" }}{{ end }}
{{ end }}
{{ end }}

{{ define "slack.tsaf.color" }}
{{ if eq .Status "firing" }}
  {{ if eq .CommonLabels.severity "critical" }}danger{{ else if eq .CommonLabels.severity "warning" }}warning{{ else }}good{{ end }}
{{ else }}
  good
{{ end }}
{{ end }}

{{ define "slack.tsaf.fallback" }}
TSAF {{ .Status | upper }}: {{ .GroupLabels.alertname }} ({{ .Alerts | len }} alerts)
{{ end }}

{{ define "slack.security.text" }}
ğŸ”’ *SECURITY ALERT* ğŸ”’

{{ range .Alerts }}
*{{ .Annotations.summary }}*
{{ .Annotations.description }}

*Threat Level:* {{ .Labels.severity | upper }}
{{ if .Labels.vulnerability_type }}*Vulnerability:* {{ .Labels.vulnerability_type }}{{ end }}
{{ if .Labels.agent_id }}*Affected Agent:* {{ .Labels.agent_id }}{{ end }}
{{ if .Labels.protocol }}*Protocol:* {{ .Labels.protocol }}{{ end }}

*Detected:* {{ .StartsAt.Format "15:04:05 UTC" }}
{{ if .EndsAt }}*Resolved:* {{ .EndsAt.Format "15:04:05 UTC" }}{{ end }}

âš ï¸ This requires immediate security team attention!
{{ end }}
{{ end }}

{{ define "slack.performance.text" }}
âš¡ *PERFORMANCE ALERT* âš¡

{{ range .Alerts }}
*{{ .Annotations.summary }}*
{{ .Annotations.description }}

*Service:* {{ .Labels.service }}
*Impact:* {{ .Labels.severity | upper }}
{{ if .Labels.protocol }}*Protocol:* {{ .Labels.protocol }}{{ end }}

*Started:* {{ .StartsAt.Format "15:04:05 UTC" }}
{{ if .EndsAt }}*Resolved:* {{ .EndsAt.Format "15:04:05 UTC" }}{{ end }}

ğŸ“Š Check Grafana dashboards for detailed metrics
{{ end }}
{{ end }}

{{ define "slack.infrastructure.text" }}
ğŸ—ï¸ *INFRASTRUCTURE ALERT* ğŸ—ï¸

{{ range .Alerts }}
*{{ .Annotations.summary }}*
{{ .Annotations.description }}

*Component:* {{ .Labels.service }}
*Status:* {{ .Labels.severity | upper }}

*Started:* {{ .StartsAt.Format "15:04:05 UTC" }}
{{ if .EndsAt }}*Resolved:* {{ .EndsAt.Format "15:04:05 UTC" }}{{ end }}

ğŸ”§ Infrastructure team please investigate
{{ end }}
{{ end }}